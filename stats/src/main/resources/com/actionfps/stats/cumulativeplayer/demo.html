<!doctype html>
<!--suppress JSUnfilteredForInLoop -->
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.3/nv.d3.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.3/nv.d3.min.css">
</head>
<body>
<div id="chart" style="height: 200px;">
    <svg></svg>
</div>

<script type="text/javascript">
    var chart = nv.models.multiBarHorizontalChart().stacked(true).showControls(false).showYAxis(false);

    var inputData = {
                "users": ["drakas", "sanzo", "lucas"],
                "games": {
                    "1418734999": ["drakas"],
                    "1419098623": ["sanzo"],
                    "1419793671": ["drakas"],
                    "1418505390": ["sanzo", "drakas"],
                    "1418496249": ["drakas"],
                    "1419095306": ["sanzo"],
                    "1419117418": ["lucas"],
                    "1418506442": ["lucas", "drakas"],
                    "1419787268": ["drakas"],
                    "1419792711": ["drakas"],
                    "1418835565": ["sanzo"],
                    "1418915631": ["sanzo", "drakas", "lucas"],
                    "1419790453": ["drakas"],
                    "1418748841": ["drakas"],
                    "1418497490": ["drakas"],
                    "1418918792": ["drakas"],
                    "1419289452": ["sanzo", "drakas"],
                    "1418507486": ["drakas", "lucas"],
                    "1419290405": ["sanzo", "drakas"],
                    "1418916631": ["sanzo", "lucas", "drakas"],
                    "1418509987": ["drakas", "sanzo", "lucas"],
                    "1419096404": ["sanzo"],
                    "1419097688": ["sanzo"],
                    "1419169724": ["drakas"],
                    "1418927096": ["drakas"],
                    "1418919825": ["drakas"],
                    "1419794822": ["drakas"],
                    "1419786220": ["drakas"],
                    "1419789393": ["drakas"],
                    "1418734020": ["drakas"],
                    "1418508755": ["drakas", "sanzo", "lucas"],
                    "1418929490": ["drakas"]
                }
            };



    var gameIds = inputData.games.sort();
    var playerCounts = {};
    inputData.users.forEach(function (user) { playerCounts[user] = 0; });
    gameIds.foreach(function(gameId, index) {
        var previousGame inputData.games[gameId]
    });

    var transformedData = inputData.users.map(function(user) {

        Object.keys(inputData.data).map(function (key) {
            return {
                key: key,
                values: inputData.data[key]
            };
        });
    }
    console.log(transformedData);
    //    transformedData = [ {key: "hey", values: [[1, 2]]} ];

    console.log(transformedData);

    nv.addGraph(function () {
        var chart = nv.models.stackedAreaChart()
                .margin({right: 100})
                .x(function (d) {
                    return d[0]
                })   //We can modify the data accessor functions...
                .y(function (d) {
                    return d[1]
                })   //...in case your data is formatted differently.
                .useInteractiveGuideline(true)    //Tooltips which show all data points. Very nice!
                .rightAlignYAxis(true)      //Let's move the y-axis to the right side.
                .interpolate(true)
                .duration(500)
                .showControls(true)       //Allow user to choose 'Stacked', 'Stream', 'Expanded' mode.
                .clipEdge(true);

        //Format x-axis labels with custom function.
        chart.xAxis
                .tickFormat(function (d) {
                    return d3.time.format('%x')(new Date(d))
                });

        chart.yAxis
                .tickFormat(d3.format(',.2f'));

        d3.select('#chart svg')
                .datum(transformedData)
                .call(chart);

        nv.utils.windowResize(chart.update);

        return chart;
    });
</script>

</body>
</html>


